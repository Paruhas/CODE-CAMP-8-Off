<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

<script>

const sales = [
    {
      id: 1,
      product: {
        id: 1,
        name: 'iPhone',
        model: '12 Pro',
        unitPrice: 48900
      },
      saleDate: '01-01-2021',
      customer: 'Sun',
      discount: 0.2,
      type: 'Cash'
    },
    {
      id: 2,
      product: {
        id: 2,
        name: 'iPhone',
        model: '12',
        unitPrice: 32900
      },
      saleDate: '01-01-2021',
      customer: 'Tle',
      type: 'Credit'
    },
    {
      id: 3,
      product: {
        id: 1,
        name: 'iPhone',
        model: '12 Pro',
        unitPrice: 36900
      },
      saleDate: '01-01-2021',
      customer: 'Beer',
      type: 'Cash'
    },
    {
      id: 4,
      product: {
        id: 3,
        name: 'Samsung',
        model: 'S21',
        unitPrice: 27900
      },
      saleDate: '01-01-2021',
      customer: 'Jit',
      discount: 0.2,
      type: 'Credit'
    },
    {
      id: 5,
      product: {
        id: 1,
        name: 'iPhone',
        model: '12 Pro',
        unitPrice: 36900
      },
      saleDate: '01-01-2021',
      customer: 'Palm',
      type: 'Cash'
    },
    {
      id: 6,
      product: {
        id: 1,
        name: 'iPhone',
        model: '12 Pro',
        unitPrice: 48900
      },
      saleDate: '01-01-2021',
      customer: 'Top',    
      type: 'Credit'
    },
    {
      id: 7,
      product: {
        id: 4,
        name: 'Oppo',
        model: 'A15',
        unitPrice: 4299
      },
      saleDate: '02-01-2021',
      customer: 'Sun',    
      type: 'Credit'
    },
    {
      id: 8,
      product: {
        id: 3,
        name: 'Samsung',
        model: 'S21',
        unitPrice: 27900
      },
      saleDate: '02-01-2021',
      customer: 'Snap',
      discount: 0.1,
      type: 'Credit'
    },
    {
      id: 9,
      product: {
        id: 5,
        name: 'iPhone',
        model: '11 Pro',
        unitPrice: 36900
      },
      saleDate: '02-01-2021',
      customer: 'Ham',
      discount: 0.25,   
      type: 'Credit'
    },
    {
      id: 10,
      product: {
        id: 6,
        name: 'Samsung',
        model: 'A31',
        unitPrice: 7999
      },
      saleDate: '02-01-2021',
      customer: 'Ham',
      discount: 0.25,   
      type: 'Credit'
    },
    {
      id: 11,
      product: {
        id: 1,
        name: 'iPhone',
        model: '12 Pro',
        unitPrice: 48900
      },
      saleDate: '02-01-2021',
      customer: 'Tle',
      discount: 0.3,
      type: 'Airpay'
    },
    {
      id: 12,
      product: {
        id: 1,
        name: 'iPhone',
        model: '12 Pro',
        unitPrice: 48900
      },
      saleDate: '02-01-2021',
      customer: 'Micky',    
      type: 'Credit'
    },
    {
      id: 13,
      product: {
        id: 2,
        name: 'iPhone',
        model: '12',
        unitPrice: 32900
      },
      saleDate: '02-01-2021',
      customer: 'Boss',
      type: 'Cash'
    },
    {
      id: 14,
      product: {
        id: 7,
        name: 'Oppo',
        model: 'Reno5',
        unitPrice: 19990
      },
      saleDate: '02-01-2021',
      customer: 'Sila',       
      type: 'Airpay'
    },
    {
      id: 15,
      product: {
        id: 8,
        name: 'Xiaomi',
        model: 'Redmi 9C',
        unitPrice: 3399
      },
      saleDate: '02-01-2021',
      customer: 'Top',       
      type: 'Cash'
    },
    {
      id: 16,
      product: {
        id: 9,
        name: 'Samsung',
        model: 'A42',
        unitPrice: 11990
      },
      saleDate: '03-01-2021',
      customer: 'Cin',       
      type: 'Cash'
    },
    {
      id: 17,
      product: {
        id: 6,
        name: 'Samsung',
        model: 'A31',
        unitPrice: 7999
      },
      saleDate: '03-01-2021',
      customer: 'Cin',       
      type: 'Cash'
    },
    {
      id: 18,
      product: {
        id: 1,
        name: 'iPhone',
        model: '12 Pro',
        unitPrice: 36900
      },
      saleDate: '03-01-2021',
      customer: 'Sine',
      discount: 0.3,
      type: 'Airpay'
    },
    {
      id: 19,
      product: {
        id: 2,
        name: 'iPhone',
        model: '12',
        unitPrice: 32900
      },
      saleDate: '03-01-2021',
      customer: 'Note',
      type: 'Credit'
    },
    {
      id: 20,
      product: {
        id: 3,
        name: 'Samsung',
        model: 'S21',
        unitPrice: 27900
      },
      saleDate: '03-01-2021',
      customer: 'Micky',    
      type: 'Credit'
    },
    {
      id: 21,
      product: {
        id: 10,
        name: 'Vivo',
        model: 'V20 Pro',
        unitPrice: 14999
      },
      saleDate: '04-01-2021',
      customer: 'Bank',       
      type: 'Cash'
    },
    {
      id: 22,
      product: {
        id: 10,
        name: 'Vivo',
        model: 'V20 Pro',
        unitPrice: 14999
      },
      saleDate: '04-01-2021',
      customer: 'Bank',       
      type: 'Cash'
    },
    {
      id: 23,
      product: {
        id: 7,
        name: 'Oppo',
        model: 'Reno5',
        unitPrice: 19990
      },
      saleDate: '04-01-2021',
      customer: 'Leo',       
      type: 'Cash'
    },
    {
      id: 24,
      product: {
        id: 9,
        name: 'Samsung',
        model: 'A42',
        unitPrice: 11990
      },
      saleDate: '04-01-2021',
      customer: 'Game',       
      type: 'Cash'
    },
    {
      id: 25,
      product: {
        id: 6,
        name: 'Samsung',
        model: 'A31',
        unitPrice: 7999
      },
      saleDate: '04-01-2021',
      customer: 'U',
      discount: 0.3,   
      type: 'Airpay'
    },
    {
      id: 26,
      product: {
        id: 1,
        name: 'iPhone',
        model: '12 Pro',
        unitPrice: 48900
      },
      saleDate: '05-01-2021',
      customer: 'Boy',    
      type: 'Credit'
    },
    {
      id: 27,
      product: {
        id: 11,
        name: 'Vivo',
        model: 'X50 Pro',
        unitPrice: 19999
      },
      saleDate: '05-01-2021',
      customer: 'Boom',       
      type: 'True Wallet'
    },
    {
      id: 28,
      product: {
        id: 12,
        name: 'Vivo',
        model: 'V20',
        unitPrice: 10999
      },
      saleDate: '05-01-2021',
      customer: 'Boom',       
      type: 'True Wallet'
    },
    {
      id: 29,
      product: {
        id: 9,
        name: 'Samsung',
        model: 'A42',
        unitPrice: 11990
      },
      saleDate: '05-01-2021',
      customer: 'Am',       
      type: 'Cash'
    },
    {
      id: 30,
      product: {
        id: 2,
        name: 'iPhone',
        model: '12',
        unitPrice: 32900
      },
      saleDate: '06-01-2021',
      customer: 'Um',
      type: 'True Wallet'
    },
    {
      id: 31,
      product: {
        id: 3,
        name: 'Samsung',
        model: 'S21',
        unitPrice: 27900
      },
      saleDate: '06-01-2021',
      customer: 'Win',
      discount: 0.25, 
      type: 'Airpay'
    },
    {
      id: 32,
      product: {
        id: 7,
        name: 'Oppo',
        model: 'Reno5',
        unitPrice: 19990
      },
      saleDate: '06-01-2021',
      customer: 'Cin',       
      type: 'Cash'
    },
    {
      id: 33,
      product: {
        id: 2,
        name: 'iPhone',
        model: '12',
        unitPrice: 32900
      },
      saleDate: '07-01-2021',
      customer: 'Palm',
      discount: 0.1,
      type: 'Credit'
    },
    {
      id: 34,
      product: {
        id: 5,
        name: 'iPhone',
        model: '11 Pro',
        unitPrice: 36900
      },
      saleDate: '07-01-2021',
      customer: 'Dom',
      discount: 0.15,   
      type: 'Credit'
    },
    {
      id: 35,
      product: {
        id: 3,
        name: 'Samsung',
        model: 'S21',
        unitPrice: 27900
      },
      saleDate: '07-01-2021',
      customer: 'Sern',    
      type: 'True Wallet'
    },
    {
      id: 36,
      product: {
        id: 13,
        name: 'iPhone',
        model: 'SE2000',
        unitPrice: 14900
      },
      saleDate: '07-01-2021',
      customer: 'Beer',       
      type: 'Cash'
    },
    {
      id: 37,
      product: {
        id: 14,
        name: 'iPhone',
        model: '12 Mini',
        unitPrice: 25900
      },
      saleDate: '07-01-2021',
      customer: 'Game',
      discount: 0.2,      
      type: 'Credit'
    },
    {
      id: 38,
      product: {
        id: 2,
        name: 'iPhone',
        model: '12',
        unitPrice: 32900
      },
      saleDate: '07-01-2021',
      customer: 'Sun',
      discount: 0.25,
      type: 'Airpay'
    },
    {
      id: 39,
      product: {
        id: 2,
        name: 'iPhone',
        model: '12',
        unitPrice: 32900
      },
      saleDate: '07-01-2021',
      customer: 'Tom',    
      type: 'Cash'
    },
    {
      id: 40,
      product: {
        id: 14,
        name: 'iPhone',
        model: '12 Mini',
        unitPrice: 25900
      },
      saleDate: '08-01-2021',
      customer: 'Ham',         
      type: 'Cash'
    },
    {
      id: 41,
      product: {
        id: 2,
        name: 'iPhone',
        model: '12',
        unitPrice: 32900
      },
      saleDate: '08-01-2021',
      customer: 'Dom',
      type: 'Credit'
    },
    {
      id: 42,
      product: {
        id: 3,
        name: 'Samsung',
        model: 'S21',
        unitPrice: 27900
      },
      saleDate: '08-01-2021',
      customer: 'Cin',    
      type: 'True Wallet'
    },
    {
      id: 43,
      product: {
        id: 3,
        name: 'Samsung',
        model: 'S21',
        unitPrice: 27900
      },
      saleDate: '08-01-2021',
      customer: 'Tle',    
      type: 'Cash'
    },
    {
      id: 44,
      product: {
        id: 7,
        name: 'Oppo',
        model: 'Reno5',
        unitPrice: 19990
      },
      saleDate: '09-01-2021',
      customer: 'U',       
      type: 'Cash'
    },
    {
      id: 45,
      product: {
        id: 11,
        name: 'Vivo',
        model: 'X50 Pro',
        unitPrice: 19999
      },
      saleDate: '09-01-2021',
      customer: 'Am',
      discount: 0.35,    
      type: 'Airpay'
    },
    {
      id: 46,
      product: {
        id: 10,
        name: 'Vivo',
        model: 'V20 Pro',
        unitPrice: 14999
      },
      saleDate: '10-01-2021',
      customer: 'Sern',       
      type: 'Cash'
    },
    {
      id: 47,
      product: {
        id: 1,
        name: 'iPhone',
        model: '12 Pro',
        unitPrice: 48900
      },
      saleDate: '10-01-2021',
      customer: 'Game',
      discount: 0.3,
      type: 'Credit'
    },
    {
      id: 48,
      product: {
        id: 9,
        name: 'Samsung',
        model: 'A42',
        unitPrice: 11990
      },
      saleDate: '10-01-2021',
      customer: 'Jit',       
      type: 'Cash'
    },
    {
      id: 49,
      product: {
        id: 14,
        name: 'iPhone',
        model: '12 Mini',
        unitPrice: 25900
      },
      saleDate: '10-01-2021',
      customer: 'Snap',         
      type: 'True Wallet'
    },
    {
      id: 50,
      product: {
        id: 2,
        name: 'iPhone',
        model: '12',
        unitPrice: 32900
      },
      saleDate: '10-01-2021',
      customer: 'Micky',
      type: 'Cash'
    },
    {
      id: 51,
      product: {
        id: 3,
        name: 'Samsung',
        model: 'S21',
        unitPrice: 27900
      },
      saleDate: '11-01-2021',
      customer: 'Boss',
      discount: 0.2,
      type: 'Credit'
    },
    {
      id: 52,
      product: {
        id: 8,
        name: 'Xiaomi',
        model: 'Redmi 9C',
        unitPrice: 3399
      },
      saleDate: '11-01-2021',
      customer: 'Leo',
      discount: 0.05,      
      type: 'Credit'
    },
    {
      id: 53,
      product: {
        id: 10,
        name: 'Vivo',
        model: 'V20 Pro',
        unitPrice: 14999
      },
      saleDate: '11-01-2021',
      customer: 'Sine',
      discount: 0.15,
      type: 'True Wallet'
    },
    {
      id: 54,
      product: {
        id: 14,
        name: 'iPhone',
        model: '12 Mini',
        unitPrice: 25900
      },
      saleDate: '07-01-2021',
      customer: 'Um',
      discount: 0.1,      
      type: 'Cash'
    },
  ]
//1 จำนวน transaction
// console.log(sales.length) 
//2 จำนวนลูกค้าที่แตกต่างกัน มีใครบ้าง ยอดรวมที่ซื้อ จำนวนเครื่อง
 //(26) 
// let newId = sales.reduce(function(acc,value){
//     if(!acc[value]){
//         acc[value.id] = value.product.unitPrice
//     } return acc
// },{})
// console.log(newId)

// let newCustomer = sales.reduce(function(acc,value){
//     if(!acc[value]){
//         acc[value.id] = value.customer
//     } return acc
// },[])
// console.log(newCustomer)

// let customerAmount = sales.reduce(function(acc,value){
//     if(!acc[value]){
//         acc[value.customer] =value.customer
//     } return acc
// },{})
// console.log(customerAmount)
// console.log(customerAmount)
// console.log(customerAmount)
// 3.ยอดขายหลังหัก discount // 1270728.1
// let amount = 0
// let sumAmount = sales.reduce(function(acc,value){
//     if(value.discount){
       
//        acc = (1-value.discount)*value.product.unitPrice
       
//     } else {
//       acc = 1*value.product.unitPrice
       
//     } 
//     amount = amount + +acc
//     return amount
//     },0)
    
    
    
    
//     console.log(amount)
//4.สินค้าที่ถูกขายมีกี่ยี่ห้อ กี่เครื่อง และยอดรวมเท่าไหร่
// let saleAmount = sales.reduce(function(acc,value){
//   if(acc[value.product.name]){
//     acc[value.product.name]++
//   } else{
//     acc[value.product.name] = 1
//   }
//   return acc
// },{})
// console.log(saleAmount)
//5.สินค้าที่ถูกขายมีกี่รุ่นในแต่ละยี่ห้อ แต่ละรุ่นขายไปกี่เครื่องและ ยอดรวมเท่าไหร่
const needResult = {
  '<product_name>': {
    models: [
      {
        model: '<model_name>',
        count: 0,
        totalSale: 0
      }
    ]
  }
}



let saleProduct = sales.reduce(function (acc, value) {

  if (!acc[value.product.name]) {

    // if(value.discount){
     
    //   b = (1-value.discount)*(value.product.unitPrice)
       
    // } else{
     
    //   b = value.product.unitPrice
    
    // }

    b = []
    b.model = value.product.model
    console.log(b)
    acc[value.product.name] = []
    acc[value.product.name].push(b)
  
    
   } else if (!acc[value.product.name].includes(value.product.model)) {
  
    // if(value.discount){
     
    //   b = (1-value.discount)*(value.product.unitPrice)
       
    // } else{
     
    //   b = value.product.unitPrice
    // }
    // acc[value.product.name].push(value.product.model);
    
    
  }
  return acc;
}, {});

console.log(saleProduct);
// let totalSale = sales.reduce(function (acc, value) {
//   if (!acc[value.product.name]) {
//     acc[value.product.name] = [value.product.unitPrice]
//   } else if (!acc[value.product.unitPrice]) {
//     acc[value.product.name].push(value.product.unitPrice);
//   }
//   return acc;
// }, {});
// console.log(totalSale);
;
//6.หายอดรวมของการจ่ายแต่ละประเภท
// let newId = sales.reduce(function(acc,value){
//   if(!acc[value]){
//       acc[value.id] = value.product.unitPrice
//   } return acc
// },{})
// console.log(newId)
// let newId2 = sales.reduce(function(acc,value){
// if(!acc[value.id]){
//     acc[value.id] = value.type
// } return acc
// },{})
// console.log(newId2)

// let mergeKey = Object.values(newId)
// console.log(mergeKey)
// let mergeValue = Object.values(newId2)
// console.log(mergeValue)
// console.log(merge)
//7.หายอดรวมในแต่ละวัน
//8.เรียงยอดขายของแต่ละรุ่นจากมากไปน้อย
// let saleModelAmount = sales.reduce(function(acc,value){
//   if(acc[value.product.model]){
//     acc[value.product.model]++
//   } else{
//     acc[value.product.model] = 1
//   }
//   return acc
  
// },{})
// console.log(saleModelAmount)
// let saleModel = Object.entries(saleModelAmount)
// console.log(saleModel)

// let sortSaleModel = saleModel.sort(function(a,b){
//   return b[1] - a[1];
// },[])
// console.log(sortSaleModel)

//9.เรียงลูกค้าที่ซื้อมากที่สุดจากมากไปน้อย
 let saleModelAmount = sales.reduce(function(acc,value){
    if(acc[value.product.model]){
      acc[value.product.model]++
    } else{
      acc[value.product.model] = 1
    }
    return acc
    
  },{})
  console.log(saleModelAmount)
  // let saleModel = Object.entries(saleModelAmount)
  // // console.log(saleModel)
  
  // let sortSaleModel = saleModel.sort(function(a,b){
  //   return a[1] - b[1];
  // },[])
  // console.log(sortSaleModel)
  
  // let a = Object.keys(sortSaleModel) 
  // let b = Object.values(sortSaleModel) 

</script>





















</head>
<body>
  ของปาม
</body>
</html>